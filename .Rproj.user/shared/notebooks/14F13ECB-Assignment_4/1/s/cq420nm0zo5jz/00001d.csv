"0","#| label: desc-stat-table"
"0","#| warning: false"
"0","#| echo: false"
"0",""
"0","# calculate stats for those with cardiac events "
"0","d_cardiac <- d %>% filter(cardiac == 1) %>% "
"0","  select(-cardiac) %>% "
"0","  summarise(across(everything(), mean)) %>% "
"0","  pivot_longer(cols = everything(), names_to = ""Variable"", values_to = ""Mean/%"")"
"0","  "
"0","d_cardiac <- d_cardiac %>% mutate(""N"" = nrow(d %>% filter(cardiac == 1)))"
"0",""
"0","# variables that should be percentages "
"0","percentage_vars <- c(""smoke"", ""female"")"
"0",""
"0","# convert Mean/% column values from mean to percentage if relevant"
"0","d_cardiac <- d_cardiac %>% "
"0","  mutate(""Mean/%"" = ifelse(Variable %in% percentage_vars, "
"0","                           paste0(sprintf(""%.1f"", `Mean/%` * 100), ""%""), "
"0","                           sprintf(""%.1f"", `Mean/%`)))"
"0",""
"0","# calculate stats for those without cardiac events "
"0","d_control <- d %>% filter(cardiac == 0) %>% "
"0","  select(-cardiac) %>% "
"0","  summarise(across(everything(), mean)) %>% "
"0","  pivot_longer(cols = everything(), names_to = ""Variable"", values_to = ""Mean/%"")"
"0",""
"0","d_control <- d_control %>% mutate(""N"" = nrow(d %>% filter(cardiac == 0)))"
"0",""
"0","# convert Mean/% column values from mean to percentage if relevant"
"0","d_control <- d_control %>% "
"0","  mutate(""Mean/%"" = ifelse(Variable %in% percentage_vars, "
"0","                                                          paste0(sprintf(""%.1f"", `Mean/%` * 100), ""%""), "
"0","                                                          sprintf(""%.1f"", `Mean/%`)))"
"0","# join columns "
"0","stats <- d_control %>% "
"0","  left_join(d_cardiac, by = ""Variable"") "
"0",""
"0","# label variables "
"0","labels <- c(""Smoker"", ""Is female"", ""Age (years)"", ""Cost of treatment ($)"")"
"0",""
"0","stats <- stats %>%"
"0","  mutate(Variable = labels) "
"0",""
"0","colnames(stats) <- c(""Variable"", ""Mean/% (control)"", ""N (control)"", ""Mean/%"", ""N"")"
"0",""
"0","# save table 1 "
"0","write.csv(stats, ""3-output/table1.csv"", row.names = FALSE)"
"0",""
"0","# create formatted table with kable for report output "
"0","kable(stats, caption = ""Table 1: Characteristics of study participants"") %>%"
"0","  kable_classic(full_width = F) %>% "
"0","  add_header_above(header = c("" "" = 1, ""No Cardiac Event"" = 2, ""Cardiac Event"" = 2)) %>%"
"0","  kable_styling() "
