"0","#| label: primary-analysis-regression"
"0","#| warning: false"
"0","#| echo: false"
"0","# run logistic regression "
"0","glm.fit1 <- glm(cardiac ~ smoke + female + age, data = d, family = ""binomial"")"
"0",""
"0","tableit <- data.frame(summary(glm.fit1)$coef)"
"0","tableit$OR <- sprintf(""%.2f"", exp(tableit$Estimate))"
"0","tableit$LCL <- sprintf(""%.2f"", exp(tableit$Estimate - tableit$Std..Error * 1.96 ))"
"0","tableit$UCL <- sprintf(""%.2f"", exp(tableit$Estimate + tableit$Std..Error * 1.96 ))"
"0","tableit$`p-value` <- sprintf(""%.3f"", tableit$Pr...z..)"
"0",""
"0","tableit <- tableit[, c(""OR"", ""LCL"", ""UCL"", ""p-value"")]"
"0",""
"0","# add row labels "
"0","labels <- c(""Intercept"", ""Smoker"", ""Is female"", ""Age (years)"")"
"0","row.names(tableit) <- labels"
"0",""
"0","# rename columns"
"0","colnames(tableit) <- c(""Odds Ratio"", ""Lower"", ""Upper"", ""P value"")"
"0",""
"0","# create formatted table with kable for report output "
"0","kable(tableit, digits = 2, caption = ""Table 2: Adjusted associations between smoking status, sex, age and cardiac events"") %>%"
"0","  kable_classic(full_width = F) %>%"
"0","  kable_styling()"
