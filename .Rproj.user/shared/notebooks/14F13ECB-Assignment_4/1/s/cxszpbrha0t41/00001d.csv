"0","#| label: secondary-analysis-regression"
"0","#| warning: false"
"0","#| echo: false"
"0","# run logistic regression with interaction term for cost and smoking"
"0","glm.fit2 <- glm(cardiac ~ female + age + cost + smoke*cost, data = d, family = ""binomial"")"
"0",""
"0","tableit2 <- data.frame(summary(glm.fit2)$coef)"
"0","tableit2$OR <- sprintf(""%.2f"", exp(tableit2$Estimate))"
"0","tableit2$LCL <- sprintf(""%.2f"", exp(tableit2$Estimate - tableit2$Std..Error * 1.96 ))"
"0","tableit2$UCL <- sprintf(""%.2f"", exp(tableit2$Estimate + tableit2$Std..Error * 1.96 ))"
"0","tableit2$`p-value` <- sprintf(""%.3f"", tableit2$Pr...z..)"
"0",""
"0","tableit2 <- tableit2[, c(""OR"", ""LCL"", ""UCL"", ""p-value"")]"
"0",""
"0","# add row labels "
"0","labels2 <- c(""Intercept"", ""Smoker"", ""Is female"", ""Age (years)"", ""Cost of treatment ($)"", ""Smoker Ã— Cost interaction"")"
"0","row.names(tableit2) <- labels2"
"0",""
"0","# rename columns"
"0","colnames(tableit2) <- c(""Odds Ratio"", ""Lower"", ""Upper"", ""P value"")"
"0",""
"0","# create formatted table with kable for report output "
"0","kable(tableit2, digits = 2, caption = ""Table 3: Effect modification by cost of treatment"") %>%"
"0","  kable_classic(full_width = F) %>%"
"0","  kable_styling()"
